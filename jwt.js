const jwt = require('jsonwebtoken');


const spki = `
-----BEGIN CERTIFICATE-----
MIIC4jCCAcoCCQC+0wx8btyDUzANBgkqhkiG9w0BAQUFADAzMQswCQYDVQQGEwJD
TjERMA8GA1UECAwIWmhlSmlhbmcxETAPBgNVBAcMCEhhbmdaaG91MB4XDTIyMDIy
NDA2MDY0NFoXDTIyMDIyNTA2MDY0NFowMzELMAkGA1UEBhMCQ04xETAPBgNVBAgM
CFpoZUppYW5nMREwDwYDVQQHDAhIYW5nWmhvdTCCASIwDQYJKoZIhvcNAQEBBQAD
ggEPADCCAQoCggEBALnqnJn6jEcRjA6TADpMu+BwaEBi8LFNaoX3wVd3omdSJt9a
tPDQLD1PmFzBzoGKFk941YyP2kr7SMceiOC/0e8Kq/DGSU9HVsLOPdaWpcQPNgvJ
l4FpHs9xbMJ8pQa1YOjo0VavDYxQ3n5MMzW3bCrI9H+5wySdqhPvmbsTs+iQJQjC
6loVjlkqRehlRXFX7Gdie+o8L8fk3Oqt/AChfWCdBNJ1C0SurACDHiqR5EKnBggK
7jif2zLZ9VZQltdA9430dGrR441FssK6hAjTHh8rulg76o+rzGLiDYBx7D5QuCRD
TDZyQzJgNmWdonicCnQwoD/da4bbJUXq6OgGdb8CAwEAATANBgkqhkiG9w0BAQUF
AAOCAQEAThpQtQBd0Vc6uullDf65hRtpeKh62NzZoFBS3mSm6DM2Hgt++8nOZJfn
hjzl0snxrTvokNA3ek7hyra8qmw5ooAmN90vLsokc1M60LoXl2/OpJqv55an7HUF
QdbaMQrtt1MZSaR6rI5GUGy1mAd9j/h2at/9g9TavCl4cSwaazjg33+uU4mWva4X
BJEVxYElIRzgYW5zWK66ZP5l5LrBkdk2A29ThEoMPVbxmb1U2S/AQJNsLZPm3SzL
U25rpDbBDjseI/7tBiuWfNnOCRtP3IahE/I8xRok4WbRO+bQ2nM9ukAsyfHD9CXT
S03o2vT9xR7pi3V17NXdHFkNY/BlMw==
-----END CERTIFICATE-----
`;

const pri = `
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAueqcmfqMRxGMDpMAOky74HBoQGLwsU1qhffBV3eiZ1Im31q0
8NAsPU+YXMHOgYoWT3jVjI/aSvtIxx6I4L/R7wqr8MZJT0dWws491palxA82C8mX
gWkez3FswnylBrVg6OjRVq8NjFDefkwzNbdsKsj0f7nDJJ2qE++ZuxOz6JAlCMLq
WhWOWSpF6GVFcVfsZ2J76jwvx+Tc6q38AKF9YJ0E0nULRK6sAIMeKpHkQqcGCAru
OJ/bMtn1VlCW10D3jfR0atHjjUWywrqECNMeHyu6WDvqj6vMYuINgHHsPlC4JENM
NnJDMmA2ZZ2ieJwKdDCgP91rhtslRero6AZ1vwIDAQABAoIBAQCHvSSTQ5uxs70H
Uwqihi3R4yAqilJjkTtKDqbp3p4DQ7a/8nETNVpndTqv1oyYhaJeacG4u7rMbgUn
5EJZnZOALNF2nL8fk91jo8MAbsMej2CNYKUuRfrJyG143hp6+GiGBJ365RpGLTEV
Ezt8Z6wg3NGug4lXrYlkvtYGAY+kJoIYVTy1b7tjWQpHs14DkPbM1PUOr2Yq4htP
gklhGkuCmeR4kPDlWkEJZQ74tCjiWWsE2AxJVdJmE4uvS+UqGwCH2kt90lD/KjxZ
UtC1CdR2g8Pti91Qsd+98omDwtoBR/rT26EYFTBYzCe+7IBpuBwBkNrulzzZFxuI
Zfyq6aHRAoGBAO6vybawB7nnADIWyhMqBcdvE+R2A4MqdZdph44ADrZYLvglLgI0
+W5hmlJGliakeaiA/yfpZ50GnXgurcxB09tBWUi1dNgAG2Vk4Nqigzl/lvxuUZpj
K/gaIvWyv7FwJl1X038PLTuR3/BJq3D+ByI2ZzEA+2Fwfl/OSudM2kV5AoGBAMdm
7MXtxieXqU/I6KQ8yVl2JOda8dw8Oz14eWwKwEheTECMsriVJqVjmNCcVVC6hq8y
RbSdSekYVCCPdUUJypiNXu0Rb3o3jPj4WfVfbcw8R9+pMKsn3XXKX8RCU+xyNPgE
9XGBslTTFY0dufH4oPUNJ5QnbqqGvMry0KvHg173AoGAH/3Pu3y8jF452HzVeNwZ
CjIJKIXo0pvORw0N7ipzzlzjbr8M+56+D91lIcH0PhmtdLhVerP9/z3zvTgEc2wf
STPpE6W+k3TwNxbeTG+bxwki45KlvVuteQOHzAa5Sr8NZVVwM4eFOIbEzSASqoJh
0mQYUKkhCF5bkdvEjlvupYECgYBN6iHKlUZAYjp+Onrs8fObSVbSL+8hp0delZyc
YvcPUAlrj46mIWGgbnJf0TZk/P1zp6klEfC3bBIzRtsDxveq9FKLP6zXjK1A+4nr
HwbALy3Gb03dEw6t4A3bmi9AzL91yjo9x/fuvSxGn77wlb4PArzcXywW5d8PTiHL
fYIPsQKBgQDW9CZsR71nvGPNkOBLjvSXJ2H63gp+qZyQdHs1O0uXxJLo9W4o5M68
ag0xDZFpvvFDTk9evgkTxLmdX01zcQCFT3wj503q8m/kjbQDc0OMRyEjaCeLxQkg
EEwG7NGJ/WxRji6RwCzrpQG4z4qVzwwtQ6Fh8kzBqtcEMPKO1IaqFA==
-----END RSA PRIVATE KEY-----
`;

const spki2 = `
-----BEGIN CERTIFICATE-----
MIIDAzCCAesCFEV1GVB+fr/SzQMOkT8RiwqCvJHuMA0GCSqGSIb3DQEBCwUAMD4x
CzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIU2FuIEpvc2UxDzAN
BgNVBAoMBkNpdGNvbjAeFw0yNDA0MDMwMzU5NDdaFw0zNDA0MDEwMzU5NDdaMD4x
CzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTERMA8GA1UEBwwIU2FuIEpvc2UxDzAN
BgNVBAoMBkNpdGNvbjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALP1
3wiSwzkkKy5u/RmEBy7WYmBISZ0MBKDgLNCDiFaRrBT+d8GjPCAV0OTEm3YdTXGG
wViiEq+sjaV0iA4l9RYKTv96XOP6ep8YgO1ihVUwRHFE1JvFjhxAZQ/31ofYYw+i
9Utva/TJY2fr41/s1I1b4wzUKeeu14JyYxb1wev9y4s0QHu+bgJjrc2mDviAky2F
FA92iPpG+Gc8VXI1uxSWGCOiAhgVYuLp4zcd47EIo+7KcUX3sVavEGEpOmA85JQZ
979vQ+T72yM5dZcMxSoSVk2h4NaL96Ipkg4pCwAmYNlxh0KdRkTsU69UiWPcWwKt
cDUvKh7OcqwEvDmoQ2cCAwEAATANBgkqhkiG9w0BAQsFAAOCAQEAQEM96NJLDfi1
xs6o/Yti/0AyILYFlfAxXGkw5T20SGL4JDUfEoWdBnCsMuHx+ZXFVeBvmctFV1V9
S2ISlP0a+pob+oYuwmZ4SFBsH5k1kmrchdOM3x5OX9qJjsLPuAf/FmFGRA7BHX0X
in50DEaJdO3GIvV8xCNeARKpL2Qx5JdNZ7jKg2B+76YWLZOSGq2ETTYH8HJkvrwc
xEy2/GO+ix6uzl6aFf0YUbzsFIbkL7nE9qCpW6mmAZJLLyVGIDx2NDUj+UOLZQFN
gY4j+z1cyBo1j+46BhcK6ggxQJ2js+gdr7IxXEEMIuj+BK71ODYXi4XFOrYW7jS7
UohdpYW9Ng==
-----END CERTIFICATE-----
`;

const payload = {
    sub: 'user123',
    name: 'John Doe',
    iat: Math.floor(Date.now() / 1000)
};

// 对称加解密
const r1 = jwt.sign(payload, 'shhhhhshhhhhshhhhhshhhhhshhhhh11');
console.log(r1)

const v1 = jwt.verify(r1, 'shhhhhshhhhhshhhhhshhhhhshhhhh11');
console.log(v1)

try {
    jwt.verify(r1, 'wrong-secret');
} catch (error) {
    console.log(error);
}

// 非对称加解密
const r2 = jwt.sign(payload, pri, { algorithm: 'RS384' });
console.log(r2)

const v2 = jwt.verify(r2, spki);
console.log(v2)

try {
    jwt.verify(r2, spki2);
} catch (error) {
    console.log(error)
}

// const r3 = 'eyJhdWQiOiJodHRwczovLzA4YTItMTAzLTExNy03Ni0xMC5uZ3Jvay1mcmVlLmFwcCIsImtpZCI6IjgzNjI4NjZkLWQ4MTYtNGI4Yy1hZGQzLTJkMTA5NDY0Nzg1YyIsImlzcyI6Imh0dHBzOi8vY2hlY2tvdXQud2FsbGV0LmNhdC5lYXJseXdhcm5pbmcuaW8iLCJ0eXAiOiJKV1QiLCJleHAiOjE3MjM3NzI3MzcsImlhdCI6MTcyMzU5OTkzNywiYWxnIjoiUlMyNTYiLCJqdGkiOiI1Qzg0MUJCNkMwMDAzNDgxOTEwNy03NzhhLTJkOGUtZjhmMy0xMTc3NjVhY2ZiMDEifQ.eyJwYXlsb2FkSWQiOiI1Qzg0MUJCNkMwMDAzNDgxOTEwNy03NzhhLTJkOGUtZjhmMy0xMTc3NjVhY2ZiMDEiLCJzZXNzaW9uSWQiOiIxNzIzNTk5NzUzNTI5Iiwic2VjdXJlZFBheWxvYWQiOiJleUpoZFdRaU9pSm9kSFJ3Y3pvdkx6QTRZVEl0TVRBekxURXhOeTAzTmkweE1DNXVaM0p2YXkxbWNtVmxMbUZ3Y0NJc0ltdHBaQ0k2SW1OcGRHTnZibDl3WVhwbFgzTmllQ0lzSW1semN5STZJbWgwZEhCek9pOHZZMmhsWTJ0dmRYUXVkMkZzYkdWMExtTmhkQzVsWVhKc2VYZGhjbTVwYm1jdWFXOGlMQ0pqZEhraU9pSktWMVFpTENKMGVYQWlPaUpLVjFRaUxDSmxibU1pT2lKQk1qVTJSME5OSWl3aVpYaHdJam94TnpJek56Y3lOek0zTENKcFlYUWlPakUzTWpNMU9UazVNemNzSW1Gc1p5STZJbEpUUVMxUFFVVlFMVEkxTmlJc0ltcDBhU0k2SWpNME9ERTVNVEEzTFRjM09HRXRNbVE0WlMxbU9HWXpMVEV4TnpjMk5XRmpabUl3TVNKOS5qYnNJcWdTdjZidmoxbWpfWl9QckFwZlZiU29SLVJaZDVabGhCeTZ2dW1yY2xZRjI2T1RYODIzNE9wNlR6NlNOeTJJMTdZVG85c19oQm1OcnJaRGVFWExGOGd0ZGdQcWFYbF9kOXphaXdjaHNxYXJwQUhIeWd1b18wVlRuTjdMb1hFd0VDUWNlSVpGcjlwTlNUT09VTjVjVjhJSmJzUDVYRjBOM2QzRFBDUldfVUYydmZuZ2xsNlZhazY2bXpOSmt0NU9zMHJDT2x6djJsR0FDQklOSEpZWDFSZTBzc0xjUDJNbG1USjBiUnZYOTBQUE0xTmNUUFZVMFZBZVFCUDdFOHQ2b0NNQUM5ZlJWVFBpdEd2dER2SGtkRmx6ZUFhVmxPX09VS3NsczlaaHZocmkxcXBDajhVT1hJVWZyUUNobEprS2ROZzJNSTRZNnVKUF9raFl4MHcuUkNOeDNkZEJNemJCM1FpNy5hWmYwbjVnQk1teklmUDlSaDRydk9QY0h2M29pWFZsV0FQU1V0cEVCXzhpR1dxXzJBa0dEUllUSlM2dXZwS2VOcWdiTEpFamlrQ0RfaWhlOURjSktLSU12SUItVnc4RmY0TDVQcXZSZXlEYUVhYTZBME9kRGNhaE1maEtyTXlTeXA4dmpRaElObENwNy1FVHg3OVlOY2ZMQ3gtOTJQZ2pqZHRncE40OWw2S3pLM2hGbjN2cy1FamF0aFJENHJNWDBBcU53cC1fR3BwV2E3Q2ZrWG1JTEd5TXctOWI5eTVfaXp2a0dPaFc1UmZJR3BBS2VXeV9YbEEzdXdrWkJkOC1ua25JNmpRaldOMnVzd1FVQzY0Y2VENkVhM0g2M211S0RleS1pdHptX3Vac0VxLUJZLU1FS3cxQUxXVVdleERlc3psTi0wS3lKei02TFBCWGJfSExnX0tqV0U2X1ZDcnJ2V09qRXhZTjZaT05uZUpQdFcweWp3QnFIU0Q2M1NmdXFNQ3JrajlDNm50VFpKY09xNVhLWUVBWml1WDBncmNtekh4RHVpWHB2VzdhMWFfYUVyWmt6TTBDMmg0cjRKUV9xazJDbmtTbDNrdWhBN21UM0EwaTcyMWdvMnJCQkZFQ2FfeHFyYm9XOXFyN1RiQ0RlZjRXQnJLdjIyX1V2MFY2ak10N3ZmMXFWbnRrOEN4UGN3REQ1bTVDTUZjTnA0U2ZiaHlDVzd1dFYxSGJzejlJWXJUcHpkMjJGbGVhdHhPQjR3T29tS3VWVlc2WUZZRlhOYjZjTGZ1UC1fRnh3azV2b2FkLXkxOWExRnFqSFVBSHpzRUs3d012S3ZybGxla2JhUG1pMjRzUk1tMjhHMWROLXdNaEFvUmpuR2dUcHdFTlk2MmYxXzhOMEFOcGdrOFRmWWFmNGVTV1hHWS02VHNzaTY3Yk9WcTN3NFZyR0dpNEV2MU8ydTZHS2FDRjA1ai1YdGpxZnJOcVFFWVg1Z2pUbDlWS2RBNk5wUTJ3cWZySmV3WnhOZERQaWJHN0k0aG45TFNZdkMycDRweXJCN3dtQVdCRC15aHJpSmhyQzhDYWFRNW1hWUdVdXJ2OEd5cGVKZUpmWG1NVEhBaF9ia3ROWlNDSTZnUmRTRVVsMDhFSlJjNHBsRG1rWFM1aGZocjVHUWplc25rdm1IcUxsZHVqNVFxQlB2TkxPbE9qZ3lJN3VtYWFZLVhxbXg2aFVCSVNrS1A0SnZ6ZGZFcmdsdjBzR2x3b3U5NFd6TlItNFcxZkJQY3JZZmptaFdTNmdNYy03XzZMYTJnQVlwSHlUSUd1V0JOV3ZVSFFnZU5CN0hrN2cwOEZPTkVXdjJGUWc4WE5FcVZReU1iZE5xeXlpdTM3QlktenpvTW1rNFZWR1lyZFJtbWUxbWwxY1VKZTh0dUVjeHdFR2E5aFdlWEJpa2hLU3NwdnZCbDFVUDZsS0w2MUg2VGV3clB4MVNqSVR6WVl4V0JPZFJhbXMtUzlndmtYR3ltbU5jOFptdGw3VC1uQ0sydzNGU0o0ZW5qUF9HRWlHLW5rZDRRZ1VNRUxIcWRyaGNQRlhERG84M2pVRDhPU19lTWZkUDhRbXVMbE0xaDhGcktaRTN5X2x2UWRvbHl1VlQ4Q2QyN3RoTHI1TTVXZGN3enpfQ1FReWJKblgweTctWkxYMThDZW5EanV1YUY5emtGV3RZQ1VUcDlmM0VBaTI2ZEI0blpMUVFNdW1OdThsLWJXM0dWNEkwQ1JudzFQSWo1amJiblBMb3M1VHFwQm1hVVB2a29VNXdLSlFDLXBjTGd3ekxmS0lfOW1GX2tzNTFucEs0NTVrUm1ZOGlfVHlIZ0dlYU5MWnpDNDlJUUxaclpteWVJZTVDZlVEOVpyNGZUakhaaS1teXNpb1p0ektjU2pJaWRpZlBVOHhUUklVbmhvcXA0VzBac202VlY4RTEzM0JmVFpZTzdvNlA4anV3VnlzQlZXdlhDLTE4c0dSUnBpLUszNy1pbmZncFZDc3A0MUIycGY2aTRNTGotVDNGVEVQM1lRejZDM3FmV3BrVjg0WkdvR2x2T2JJaVI2RjNrNzRMUnJndC1waDRSWFNvSjlnWnJYOWtJdTh3eERacjByc0FydmdPWS1Va2FSOExJWHk5aVVrT3E5czdjSDRfLVhfOW9tVTRaTmcwbFVpRkZuZ1hmZ0xoZDZ0ZGZWZ0ExZjF2UW8zU2VfUVpHNGEzTWFnaW03T25rcm8wYTZ1QTZnaVAyTTMtS3lfVlhYWW1JaUYtRXBzbEVCWG5PbWRCVmxRWS1IRU9EZmUwbThGOXZpQzRyTk9IN0NEWEJQS0lWOE9zdDY1Y1lQcmwxR205emR3ejduZG41Nld4OVFpS3BrQkl0TlVpSnlBVWxFRHlMcnlsQmM0QnpUSU03Q212eklfamFDSkpCeEZZLVpOcjloSGdKLTRwcUJkTXk0ejJzSERoelJEcUdQNmRNWXo3SDVRUmxJeExzN3ZQMng2RFp3YWN4VVE4azZoUTlFcWdjWlN3eDhEb2hYTFluRXBzakRSemdJdWtOajFzUFNEcV9tOUFfQmxzWVZHeFVaVW94QnJRQ0VJenYtMld2Tm53VTFxZUg5ZHVwMWNtMHcxMTdac1h3RW5oWVdHd3U1dk5xTHBoUXZnSGhTdE83bVF6czRKaWVnOG5kUy10Tk12clhZTjBSOE5SaFZSSm5LVkxnVTc2U1ZGNW1FNDFzRC14QlgzakNZcS1GaGZuTV9JWEJIbGduY1pYSE1zNHBKcTdqcE9RUkNjY3BnTXU5YVljQXFUb1F5UGl5VFEwNnNnTlVDS21pbFdINWpKTEJZY25xdDRyUzdGLXI3Sk0zNEhucmJUVE0ybngtRk5FSHlxaEVGeTUtMFRKZVotQVdFbTY2bi1YVlZaSW1rX3ZBenZfZzdKYnlzLkhKMTRNNDhEeVRQX1QyZVlYWlFfYmcifQ.WYi_W-gw0M6kk2riFWrVZDG6YBO4DZyY672-UqvHtwmZiiDmAPt-Hjw82MMVuG4gf84rJTAjux75zEGvmUOUIDc9I6qhAs9rcExEtJV0-NeMKyMK39CIDd1tmsTG7r13Z8bkI7Fnv44p2cX0qKXK5t8OQK8DrEsbmSWhtOjWwjKh1ZY-ZnUhVs3qjO_ElXl7Cx3HSOD__JqVTzRekf9WB7Q-pNrXVIauPmsyaZp2I7pvqvbH2MBjDZLIvffPjD3CJEP7Bcl6NTBxgzXRpqY6uPJ-0tbWrFaLLEHI4QPiDgCNa4HOiCXO8snu6duhWZoYwG6xS1C0i_dfWJKrh0GuJQ';
// const v3 = jwt.verify(r3, spki2);
// console.log(v3);
